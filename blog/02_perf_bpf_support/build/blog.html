<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Build Perf with BPF support</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='blog.css' rel='stylesheet' type='text/css' /> 
<meta content='blog.tex' name='src' /> 
</head><body>
   <div class='maketitle'>



<h2 class='titleHead'>Build Perf with BPF support</h2>
<div class='author'></div><br />
<div class='date'><span class='cmr-12'>November 12, 2024</span></div>
   </div>
   <figure class='figure' id='-perf-software-complaining-for-missing-libraries-to-showannotate-internals-of-bpf-program'> 


<a id='x1-21'></a>

<!-- l. 11 --><p class='noindent'><img alt='PIC' src='perf_bpf_err.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 1:</span><span class='content'>Perf  software  complaining  for  missing  libraries  to  show/annotate
internals of BPF program.</span></figcaption><!-- tex4ht:label?: x1-21  -->

   </figure>
<!-- l. 16 --><p class='indent'>   I have lost a few hours figuring out why when I build <span class='cmti-10'>perf</span>, it can not
annotate BPF programs. I solved the issue before; did not document it,
and found my self in the same situation again. Wasting time, checking all
if all the libraries are installed. This note is to save my future self some
time.
</p><!-- l. 21 --><p class='indent'>   In order to support BPF annotation perf (at the moment) requires <span class='cmtt-10'>LIBBFD </span>and
<span class='cmtt-10'>LIBBPF</span>. (To find the needed libraries search the error message “<span class='cmtt-10'>enable BPF anno</span>”.
The code is at “<span class='cmtt-10'>utils/annotate.c</span>”) But having the libraries are not enough, you
need to define <span class='cmtt-10'>BUILD_NONDISTRO </span>flag when invoking <span class='cmtt-10'>make </span>so that the <span class='cmtt-10'>make </span>actually
sets the appropriate flags.
</p>
    
</body> 
</html>